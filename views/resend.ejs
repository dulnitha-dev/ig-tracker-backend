<section class="m-0 p-4 h-screen bg-blue-600" id="checkout">
  <div class="container h-full">
    <a href="/" class="flex items-center gap-1 absolute top-6 left-1/2 -translate-x-1/2">
      <img
        src="/img/icon.png"
        alt="Logo"
        draggable="false"
        class="w-8 group-[.is-sticky]:invert group-[.is-sticky]:dark:invert-0 transition duration-300" />
      <span class="text-2xl font-semibold">IG Tracker</span>
    </a>

    <div class="flex items-center justify-center w-full h-full">
      <div class="p-10 w-full max-w-xl text-center bg-white dark:bg-slate-900">
        <% if (msg) { %>
        <p class="<%= msg.type %>"><%= msg.message %></p>
        <% } %>

        <h1 class="mt-6 mb-1 text-2xl font-semibold">Resend Email</h1>
        <form class="my-6" id="form">
          <div class="mb-2 w-full">
            <input type="email" class="w-full" id="email" placeholder="Enter your email..." />
          </div>
          <button class="button bg-emerald-500 w-full">Resend Token</button>
        </form>
      </div>
    </div>
  </div>
</section>

<script>
  const redirectUrl = async (url, body) => {
    console.log("Fetching...");
    const response = await fetch(url, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: body,
    });
    const data = await response.json();
    console.log(data);
    if (data.url) window.location.href = data.url;
    else window.location.reload();
  };

  $("#form").submit((e) => {
    e.preventDefault();
    redirectUrl("/token/resend", JSON.stringify({ email: $("#email").val() }));
  });
</script>
